<div class="overflow-x-auto">
    <table class="min-w-full text-sm divide-y divide-gray-200 dark:divide-gray-700">
        <!-- Cabecera -->
        <thead class="bg-gray-50 dark:bg-gray-800">
            <tr>
                <th *ngFor="let c of columns" [style.width]="c.width" [class.text-right]="c.align === 'right'"
                    [class.text-center]="c.align === 'center'"
                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    {{ c.header | translate }}
                </th>
                <th class="px-6 py-3 w-[120px] text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    Acciones
                </th>
            </tr>
        </thead>

        <!-- Cuerpo -->
        <tbody class="bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700">
            <!-- Loading state -->
            <tr *ngIf="loading" class="animate-pulse">
                <td [attr.colspan]="columns.length + 1" class="px-6 py-8 text-center text-gray-500 dark:text-gray-400">
                    <div class="flex items-center justify-center space-x-2">
                        <div class="w-4 h-4 bg-blue-500 rounded-full animate-bounce"></div>
                        <div class="w-4 h-4 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-4 h-4 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        <span class="ml-2">Cargando...</span>
                    </div>
                </td>
            </tr>
            <!-- Data rows -->
            <tr *ngFor="let row of data; trackBy: track" class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors group" [class.hidden]="loading">

        <ng-container *ngFor="let c of columns">
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100" [class.text-right]="c.align === 'right'"
                    [class.text-center]="c.align === 'center'">

                <!-- Contenido -->
                <ng-container *ngIf="c.tpl; else plain">
                    <ng-container *ngTemplateOutlet="templates[c.tpl]; context: { $implicit: row }"></ng-container>
                </ng-container>

                <ng-template #plain>
                    <span class="text-gray-900 dark:text-gray-100">
                        <ng-container *ngIf="c.translateContent; else rawContent">
                            {{ cell(row, c) | translate }} <!-- Con traducción -->
                        </ng-container>
                        <ng-template #rawContent>
                            {{ cell(row, c) || '—' }} <!-- Sin traducción -->
                        </ng-template>
                    </span>    
                </ng-template>
            </td>
        </ng-container>

                <!-- Acciones -->
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <div class="flex justify-end gap-2">
                        <button *ngIf="canViewDetails()" (click)="onViewClick(getId(row))"
                            class="p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors" title="Ver detalle">
                            <lucide-icon [name]="eye" class="w-4 h-4"></lucide-icon>
                        </button>
                
                        <button *ngIf="canEdit()" (click)="onEditClick(getId(row))" 
                            class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md transition-colors" title="Editar">
                            <lucide-icon [name]="edit" class="w-4 h-4"></lucide-icon>
                        </button>
                
                        <button type="button" *ngIf="canDelete()" 
                            class="p-2 text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors"
                            (click)="onDelete(getId(row))" title="Eliminar">
                            <lucide-icon [name]="trash" class="w-4 h-4"></lucide-icon>
                        </button>
                    </div>
                </td>
             </tr>

            <!-- Sin datos -->
            <tr *ngIf="!data?.length">
                <td [attr.colspan]="columns.length + 1" class="px-6 py-12 text-center">
                    <div class="flex flex-col items-center gap-3 text-gray-500 dark:text-gray-400">
                        <lucide-icon [name]="database" class="w-12 h-12 text-gray-400 dark:text-gray-500"></lucide-icon>
                        <span class="text-sm font-medium">{{ "common.noData" | translate }}</span>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

       