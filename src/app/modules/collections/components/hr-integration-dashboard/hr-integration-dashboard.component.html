<div class="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-100">
  <!-- Header -->
  <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 shadow-2xl">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
        <div class="flex-1">
          <h1 class="text-3xl lg:text-4xl font-bold text-white mb-2 tracking-tight">
            Dashboard Integrado HR
          </h1>
          <p class="text-blue-100 text-lg font-medium">
            Gestión centralizada de comisiones y verificaciones de pagos
          </p>
        </div>
        <div class="flex flex-wrap gap-3">
          <button class="bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed" (click)="refreshData()" [disabled]="loading">
            <lucide-icon [name]="refreshCw" class="w-5 h-5" [class.animate-spin]="loading"></lucide-icon>
            Actualizar
          </button>
          
          <button class="bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed" (click)="syncData()" [disabled]="loading">
            <lucide-icon [name]="refreshCcw" class="w-5 h-5"></lucide-icon>
            Sincronizar
          </button>
          
          <button class="bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed" (click)="exportData()" [disabled]="loading">
            <lucide-icon [name]="download" class="w-5 h-5"></lucide-icon>
            Exportar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Filtros -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-8">
      <div class="flex items-center gap-3 mb-6">
        <div class="p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg">
          <lucide-icon [name]="filter" class="w-6 h-6 text-white"></lucide-icon>
        </div>
        <h2 class="text-2xl font-bold text-gray-800">Filtros de Búsqueda</h2>
      </div>
      
      <form [formGroup]="filterForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Período</label>
            <input type="month" 
                   formControlName="period"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Empleado</label>
            <select formControlName="employee_id" 
                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
              <option value="">Todos los empleados</option>
              <option *ngFor="let employee of employees" [value]="employee.employee_id">
                {{employee.first_name}} {{employee.last_name}}
              </option>
            </select>
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Estado de Comisión</label>
            <select formControlName="commission_status"
                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
              <option *ngFor="let status of commissionStatuses" [value]="status.value">
                {{status.label}}
              </option>
            </select>
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Estado de Verificación</label>
            <select formControlName="verification_status"
                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
              <option *ngFor="let status of verificationStatuses" [value]="status.value">
                {{status.label}}
              </option>
            </select>
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Fecha Desde</label>
            <input type="date" 
                   formControlName="date_from"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
          </div>
          
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">Fecha Hasta</label>
            <input type="date" 
                   formControlName="date_to"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
          </div>
          
          <div class="space-y-2 md:col-span-2">
            <label class="block text-sm font-semibold text-gray-700">Buscar</label>
            <div class="relative">
              <input type="text" 
                     formControlName="search"
                     placeholder="Buscar por empleado, monto, etc."
                     class="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-200 bg-white shadow-sm">
              <lucide-icon [name]="search" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"></lucide-icon>
            </div>
          </div>
        </div>
        
        <div class="flex flex-wrap gap-4 justify-end pt-4 border-t border-gray-200">
          <button class="border-2 border-gray-300 text-gray-700 hover:bg-gray-50 px-8 py-3 rounded-xl flex items-center gap-3 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-semibold" type="button" (click)="clearFilters()">
            <lucide-icon [name]="x" class="w-5 h-5"></lucide-icon>
            Limpiar Filtros
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Estadísticas -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-8" *ngIf="integrationData">
      <div class="flex items-center gap-3 mb-8">
        <div class="p-2 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-lg">
          <lucide-icon [name]="barChart3" class="w-6 h-6 text-white"></lucide-icon>
        </div>
        <h2 class="text-2xl font-bold text-gray-800">Estadísticas de Integración</h2>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Total Comisiones -->
        <div class="group relative overflow-hidden bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 cursor-pointer">
          <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative z-10">
            <div class="flex items-center justify-between mb-4">
              <div class="p-3 bg-white/20 backdrop-blur-sm rounded-xl">
                <lucide-icon [name]="dollarSign" class="w-8 h-8 text-white"></lucide-icon>
              </div>
              <div class="text-right">
                <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse"></div>
              </div>
            </div>
            <div>
              <p class="text-blue-100 text-sm font-semibold uppercase tracking-wide mb-1">Total Comisiones</p>
              <p class="text-3xl font-bold text-white mb-2">{{integrationData.stats.total_commissions | number}}</p>
              <p class="text-blue-200 text-lg font-medium">{{formatCurrency(integrationData.stats.total_commission_amount)}}</p>
            </div>
          </div>
          <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-white/5 rounded-full"></div>
        </div>
        
        <!-- Pendientes -->
        <div class="group relative overflow-hidden bg-gradient-to-br from-amber-500 via-orange-500 to-red-500 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 cursor-pointer">
          <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative z-10">
            <div class="flex items-center justify-between mb-4">
              <div class="p-3 bg-white/20 backdrop-blur-sm rounded-xl">
                <lucide-icon [name]="clock" class="w-8 h-8 text-white"></lucide-icon>
              </div>
              <div class="text-right">
                <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse"></div>
              </div>
            </div>
            <div>
              <p class="text-orange-100 text-sm font-semibold uppercase tracking-wide mb-1">Pendientes</p>
              <p class="text-3xl font-bold text-white mb-2">{{integrationData.stats.pending_verification_commissions | number}}</p>
              <p class="text-orange-200 text-lg font-medium">{{formatCurrency(integrationData.stats.pending_amount)}}</p>
            </div>
          </div>
          <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-white/5 rounded-full"></div>
        </div>
        
        <!-- Verificadas -->
        <div class="group relative overflow-hidden bg-gradient-to-br from-emerald-500 via-green-600 to-teal-600 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 cursor-pointer">
          <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative z-10">
            <div class="flex items-center justify-between mb-4">
              <div class="p-3 bg-white/20 backdrop-blur-sm rounded-xl">
                <lucide-icon [name]="checkCircle" class="w-8 h-8 text-white"></lucide-icon>
              </div>
              <div class="text-right">
                <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse"></div>
              </div>
            </div>
            <div>
              <p class="text-green-100 text-sm font-semibold uppercase tracking-wide mb-1">Verificadas</p>
              <p class="text-3xl font-bold text-white mb-2">{{integrationData.stats.verified_commissions | number}}</p>
              <p class="text-green-200 text-lg font-medium">{{formatCurrency(integrationData.stats.verified_amount)}}</p>
            </div>
          </div>
          <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-white/5 rounded-full"></div>
        </div>
        
        <!-- Fallidas -->
        <div class="group relative overflow-hidden bg-gradient-to-br from-red-500 via-pink-600 to-purple-600 rounded-2xl p-6 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105 cursor-pointer">
          <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative z-10">
            <div class="flex items-center justify-between mb-4">
              <div class="p-3 bg-white/20 backdrop-blur-sm rounded-xl">
                <lucide-icon [name]="xCircle" class="w-8 h-8 text-white"></lucide-icon>
              </div>
              <div class="text-right">
                <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse"></div>
              </div>
            </div>
            <div>
              <p class="text-red-100 text-sm font-semibold uppercase tracking-wide mb-1">Fallidas</p>
              <p class="text-3xl font-bold text-white mb-2">{{integrationData.stats.failed_verification_commissions | number}}</p>
              <p class="text-red-200 text-lg font-medium">{{formatPercentage(integrationData.stats.verification_rate)}} tasa éxito</p>
            </div>
          </div>
          <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-white/5 rounded-full"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Gráficos -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8" *ngIf="integrationData">
      <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8">
        <div class="flex items-center gap-3 mb-6">
          <div class="p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg">
            <lucide-icon [name]="pieChart" class="w-6 h-6 text-white"></lucide-icon>
          </div>
          <h3 class="text-xl font-bold text-gray-800">Estado de Verificaciones</h3>
        </div>
        <div class="relative">
          <canvas 
            *ngIf="verificationStatusChart" 
            baseChart
            [data]="verificationStatusChart"
            [options]="chartOptions"
            type="doughnut"
            class="max-w-full h-auto">
          </canvas>
        </div>
      </div>
      
      <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8">
        <div class="flex items-center gap-3 mb-6">
          <div class="p-2 bg-gradient-to-r from-indigo-500 to-blue-600 rounded-lg">
            <lucide-icon [name]="barChart" class="w-6 h-6 text-white"></lucide-icon>
          </div>
          <h3 class="text-xl font-bold text-gray-800">Montos por Estado</h3>
        </div>
        <div class="relative">
          <canvas 
            *ngIf="commissionAmountChart" 
            baseChart
            [data]="commissionAmountChart"
            [options]="chartOptions"
            type="bar"
            class="max-w-full h-auto">
          </canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabla de Comisiones -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-8" *ngIf="integrationData">
      <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6">
        <div class="flex items-center gap-3">
          <div class="p-2 bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg">
            <lucide-icon [name]="dollarSign" class="w-6 h-6 text-white"></lucide-icon>
          </div>
          <h2 class="text-2xl font-bold text-gray-800">Comisiones con Verificaciones</h2>
        </div>
        <div class="flex flex-wrap gap-3">
          <button 
            class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed font-semibold"
            (click)="selectAllCommissions()"
            [disabled]="loading">
            <lucide-icon [name]="checkSquare" class="w-5 h-5"></lucide-icon>
            Seleccionar Elegibles
          </button>
          
          <button 
            class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed font-semibold"
            (click)="processSelectedCommissions()"
            [disabled]="selectedCommissions.length === 0 || loading">
            <lucide-icon [name]="playCircle" class="w-5 h-5"></lucide-icon>
            Procesar Seleccionadas ({{selectedCommissions.length}})
          </button>
          
          <button 
            class="border-2 border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-3 rounded-xl flex items-center gap-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed font-semibold"
            (click)="clearSelection()"
            [disabled]="selectedCommissions.length === 0">
            <lucide-icon [name]="xCircle" class="w-5 h-5"></lucide-icon>
            Limpiar Selección
          </button>
        </div>
      </div>
    
    <div>
       <div class="overflow-x-auto rounded-2xl border border-gray-200/50 shadow-lg">
         <table class="min-w-full bg-white/90 backdrop-blur-sm">
           <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
             <tr>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                 <input type="checkbox" 
                        (change)="$event.target.checked ? selectAllCommissions() : clearSelection()"
                        [checked]="isAllSelected()"
                        [indeterminate]="isIndeterminate()"
                        class="w-4 h-4 rounded border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200">
               </th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">ID Comisión</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Empleado</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Monto</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Estado Pago</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Estado Verificación</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Resumen Verificación</th>
               <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Acciones</th>
             </tr>
           </thead>
           <tbody class="divide-y divide-gray-200/50">
             <tr *ngFor="let commission of integrationData.commissions; let i = index" class="hover:bg-gray-50">
               <td class="px-6 py-5 whitespace-nowrap">
                 <input type="checkbox" 
                        *ngIf="commission.verification_summary?.can_be_paid"
                        (click)="$event.stopPropagation()"
                        (change)="toggleCommissionSelection(commission.commission_id)"
                        [checked]="isCommissionSelected(commission.commission_id)"
                        class="w-4 h-4 rounded border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200">
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <span class="text-sm font-bold text-gray-900 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">#{{commission.commission_id}}</span>
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <div class="text-sm">
                   <div class="font-semibold text-gray-900">{{commission.employee?.first_name}} {{commission.employee?.last_name}}</div>
                   <div class="text-gray-500 text-xs">ID: {{commission.employee?.employee_id}}</div>
                 </div>
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <span class="text-lg font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent">{{formatCurrency(commission.commission_amount)}}</span>
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full shadow-sm"
                       [ngClass]="{
                         'bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200': commission.payment_status === 'pagado',
                         'bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border border-yellow-200': commission.payment_status === 'pendiente',
                         'bg-gradient-to-r from-gray-100 to-slate-100 text-gray-800 border border-gray-200': commission.payment_status !== 'pagado' && commission.payment_status !== 'pendiente'
                       }">
                   {{commission.payment_status}}
                 </span>
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <span *ngIf="commission.payment_verification_status"
                       class="inline-flex px-3 py-1 text-xs font-bold rounded-full shadow-sm"
                       [ngClass]="{
                         'bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200': commission.payment_verification_status === 'fully_verified',
                         'bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border border-yellow-200': commission.payment_verification_status === 'pending_verification' || commission.payment_verification_status === 'first_payment_verified' || commission.payment_verification_status === 'second_payment_verified',
                         'bg-gradient-to-r from-red-100 to-pink-100 text-red-800 border border-red-200': commission.payment_verification_status === 'verification_failed'
                       }">
                   {{getVerificationStatusLabel(commission.payment_verification_status)}}
                 </span>
                 <span *ngIf="!commission.payment_verification_status" class="text-sm text-gray-500 italic">Sin verificación</span>
               </td>
               <td class="px-6 py-5 whitespace-nowrap">
                 <div *ngIf="commission.verification_summary" class="text-sm space-y-2">
                   <div class="flex items-center space-x-3">
                     <span class="flex items-center text-green-600 font-semibold">
                       <lucide-icon [name]="checkCircle" class="w-4 h-4 mr-1"></lucide-icon>
                       {{commission.verification_summary.verified_verifications}}
                     </span>
                     <span class="flex items-center text-yellow-600 font-semibold">
                       <lucide-icon [name]="clock" class="w-4 h-4 mr-1"></lucide-icon>
                       {{commission.verification_summary.pending_verifications}}
                     </span>
                     <span class="flex items-center text-red-600 font-semibold">
                       <lucide-icon [name]="xCircle" class="w-4 h-4 mr-1"></lucide-icon>
                       {{commission.verification_summary.failed_verifications}}
                     </span>
                   </div>
                   <span *ngIf="commission.verification_summary.can_be_paid"
                         class="inline-flex items-center px-3 py-1 text-xs font-bold rounded-full bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-800 border border-blue-200 shadow-sm">
                     <lucide-icon [name]="creditCard" class="w-3 h-3 mr-1"></lucide-icon>
                     Elegible para pago
                   </span>
                 </div>
                 <span *ngIf="!commission.verification_summary" class="text-sm text-gray-500 italic">Sin verificaciones</span>
               </td>
               <td class="px-6 py-5 whitespace-nowrap text-sm font-medium">
                 <div class="flex space-x-2">
                   <button class="p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-xl transition-all duration-200 transform hover:scale-110 shadow-sm hover:shadow-md"
                           title="Ver detalles">
                     <lucide-icon [name]="eye" class="w-5 h-5"></lucide-icon>
                   </button>
                   
                   <button *ngIf="commission.verification_summary && commission.verification_summary.pending_verifications > 0"
                           class="p-2 text-green-600 hover:text-green-800 hover:bg-green-100 rounded-xl transition-all duration-200 transform hover:scale-110 shadow-sm hover:shadow-md"
                           title="Verificar pagos">
                     <lucide-icon [name]="checkSquare" class="w-5 h-5"></lucide-icon>
                   </button>
                   
                   <button *ngIf="commission.verification_summary && !commission.verification_summary.can_be_paid"
                           class="p-2 text-orange-600 hover:text-orange-800 hover:bg-orange-100 rounded-xl transition-all duration-200 transform hover:scale-110 shadow-sm hover:shadow-md"
                           title="Marcar como elegible">
                     <lucide-icon [name]="userCheck" class="w-5 h-5"></lucide-icon>
                   </button>
                 </div>
               </td>
               </tr>
             </table>
       </div>
      
       <!-- Empty State -->
       <div class="text-center py-16" *ngIf="integrationData.commissions.length === 0">
         <div class="bg-gradient-to-br from-gray-100 to-gray-200 rounded-full w-24 h-24 mx-auto mb-6 flex items-center justify-center">
           <lucide-icon [name]="inbox" class="w-12 h-12 text-gray-400"></lucide-icon>
         </div>
         <h3 class="text-xl font-bold text-gray-700 mb-3">No hay comisiones</h3>
         <p class="text-gray-500 text-lg">No se encontraron comisiones con los filtros aplicados.</p>
       </div>
     </div>
   </div>

   <!-- Verificaciones Recientes -->
   <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-8 mb-8" *ngIf="integrationData">
     <div class="flex items-center gap-3 mb-8">
       <div class="p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg">
         <lucide-icon [name]="clock" class="w-6 h-6 text-white"></lucide-icon>
       </div>
       <h2 class="text-2xl font-bold text-gray-800">Verificaciones Recientes</h2>
     </div>
     
     <div class="space-y-4">
       <div 
         class="group bg-gradient-to-r from-white to-gray-50 border border-gray-200/50 rounded-xl p-6 hover:shadow-lg transition-all duration-300 transform hover:scale-[1.02]" 
         *ngFor="let verification of integrationData.recent_verifications">
         <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
           <div class="flex-1">
             <div class="flex items-center gap-3 mb-3">
               <span class="text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">#{{verification.id}}</span>
               <span class="inline-flex px-3 py-1 text-xs font-bold rounded-full shadow-sm"
                     [ngClass]="{
                       'bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200': verification.verification_status === 'verified',
                       'bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border border-yellow-200': verification.verification_status === 'pending',
                       'bg-gradient-to-r from-red-100 to-pink-100 text-red-800 border border-red-200': verification.verification_status === 'failed'
                     }">
                 {{verification.verification_status}}
               </span>
             </div>
             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
               <div>
                 <span class="font-semibold text-gray-700">Comisión:</span>
                 <span class="text-gray-900 ml-1">#{{verification.commission_id}}</span>
               </div>
               <div>
                 <span class="font-semibold text-gray-700">Monto:</span>
                 <span class="text-gray-900 ml-1 font-bold">{{formatCurrency(verification.payment_amount)}}</span>
               </div>
               <div>
                 <span class="font-semibold text-gray-700">Fecha:</span>
                 <span class="text-gray-900 ml-1">{{verification.payment_date | date:'short'}}</span>
               </div>
               <div *ngIf="verification.verification_notes">
                 <span class="font-semibold text-gray-700">Notas:</span>
                 <span class="text-gray-900 ml-1">{{verification.verification_notes}}</span>
               </div>
             </div>
           </div>
         </div>
       </div>
       
       <div class="text-center py-12" *ngIf="!integrationData.recent_verifications || integrationData.recent_verifications.length === 0">
         <div class="bg-gradient-to-br from-gray-100 to-gray-200 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center">
           <lucide-icon [name]="history" class="w-10 h-10 text-gray-400"></lucide-icon>
         </div>
         <p class="text-gray-500 text-lg font-medium">No hay verificaciones recientes</p>
       </div>
     </div>
   </div>
  </div>

  <!-- Loading Overlay -->
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50" *ngIf="loading">
    <div class="bg-white/90 backdrop-blur-sm rounded-2xl p-8 flex flex-col items-center space-y-6 shadow-2xl border border-white/20">
      <div class="relative">
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-gray-200"></div>
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent absolute top-0 left-0"></div>
      </div>
      <div class="text-center">
        <p class="text-gray-800 font-bold text-lg mb-2">Cargando datos de integración...</p>
        <p class="text-gray-600">Por favor espere un momento</p>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" *ngIf="error && !loading">
    <div class="bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-2xl p-8 text-center shadow-xl">
      <div class="bg-gradient-to-br from-red-100 to-pink-100 rounded-full w-20 h-20 mx-auto mb-6 flex items-center justify-center">
        <lucide-icon [name]="alertCircle" class="w-10 h-10 text-red-600"></lucide-icon>
      </div>
      <h3 class="text-2xl font-bold text-red-800 mb-4">Error al cargar datos</h3>
      <p class="text-red-700 mb-6 text-lg">{{error}}</p>
      <button class="bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white px-8 py-3 rounded-xl flex items-center gap-3 mx-auto transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-semibold" (click)="loadIntegrationData()">
        <lucide-icon [name]="refreshCw" class="w-5 h-5"></lucide-icon>
        Reintentar
      </button>
    </div>
  </div>
</div>