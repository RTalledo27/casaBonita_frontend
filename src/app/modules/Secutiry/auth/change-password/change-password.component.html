<div
  class="flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900 p-4 sm:p-8 select-none font-sans text-gray-800 dark:text-gray-100">

  <!-- Main Card Container -->
  <div
    class="flex flex-col md:flex-row w-full max-w-5xl bg-white dark:bg-gray-800 rounded-3xl shadow-2xl relative md:min-h-[550px] overflow-hidden border border-gray-100 dark:border-gray-700">

    <!-- Panel Izquierdo (Info con curva integrada) -->
    <div
      class="w-full md:w-[45%] bg-[#0b132b] text-white flex flex-col justify-center px-10 py-16 md:py-12 relative z-10 transition-colors duration-300">

      <!-- Curva SVG (Solo en desktop) -->
      <svg viewBox="0 0 100 1000" preserveAspectRatio="none"
        class="absolute top-0 -right-[4.9rem] h-full w-20 text-[#0b132b] fill-current z-10 hidden md:block transition-colors duration-300">
        <path d="M0,0 C120,200 -30,600 100,1000 L0,1000 Z" />
      </svg>

      <!-- Contenido del Panel Izquierdo -->
      <div class="relative z-20 flex flex-col h-full w-full max-w-sm mx-auto pr-4">
        <!-- Logo Casa Bonita -->
        <div class="mb-8 lg:mb-10">
          <img [src]="'assets/img/casaBonitaTransparente.png'" alt="Casa Bonita Residencial" class="w-48 mb-2" />
        </div>

        <!-- Título y Descripción -->
        <h2 class="text-3xl font-bold mb-2 tracking-wide text-yellow-500">
          Seguridad
        </h2>
        <p class="text-gray-300 text-[13px] mb-10 leading-relaxed font-light">
          Protegemos la información de tu cuenta y la de tus clientes con los más altos estándares de seguridad.
        </p>

        <!-- Puntos Informativos -->
        <div class="space-y-6">
          <!-- Item 1: Contraseña temporal -->
          <div class="flex items-start group">
            <div
              class="bg-amber-500/10 p-2.5 rounded-xl mr-4 shadow-inner border border-amber-500/20 group-hover:bg-amber-500/20 transition-colors">
              <lucide-icon [img]="AlertCircle" class="h-5 w-5 text-amber-400"></lucide-icon>
            </div>
            <div>
              <h3 class="font-medium text-[15px] text-amber-50 drop-shadow-md">Acceso Limitado</h3>
              <p class="text-xs text-gray-400 mt-1 leading-snug">
                Tu contraseña actual es temporal. Es indispensable que establezcas una nueva para ingresar a la
                plataforma.
              </p>
            </div>
          </div>

          <!-- Item 2: Requisitos -->
          <div class="flex items-start group">
            <div
              class="bg-blue-500/10 p-2.5 rounded-xl mr-4 shadow-inner border border-blue-500/20 group-hover:bg-blue-500/20 transition-colors">
              <lucide-icon [img]="Lock" class="h-5 w-5 text-blue-400"></lucide-icon>
            </div>
            <div>
              <h3 class="font-medium text-[15px] text-blue-50 drop-shadow-md">Contraseña Fuerte</h3>
              <p class="text-xs text-gray-400 mt-1 leading-snug">
                Combina mayúsculas, minúsculas, números y caracteres especiales para garantizar la protección de tus
                datos.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel Derecho (Formulario) -->
    <div
      class="w-full md:w-[55%] bg-white dark:bg-gray-800 flex flex-col justify-center items-center py-12 px-6 sm:px-10 lg:px-16 relative z-0 h-full pb-16">

      <div class="w-full max-w-sm md:ml-12 lg:ml-16">
        <!-- Títulos del Formulario -->
        <div class="text-center mb-10">
          <h2 class="text-2xl lg:text-3xl font-black text-[#0b132b] dark:text-white tracking-widest uppercase mb-1">
            Actualizar Clave
          </h2>
          <p class="text-xs lg:text-[13px] text-gray-400 dark:text-gray-400 tracking-wider uppercase font-semibold">
            Cambio Obligatorio
          </p>
        </div>

        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="space-y-7">
          <!-- Current Password -->
          <div class="relative shadow-sm rounded-full bg-gray-50 dark:bg-gray-900/50 group">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
              <lucide-icon [img]="Lock"
                class="h-5 w-5 text-gray-400 group-focus-within:text-yellow-500 transition-colors"></lucide-icon>
            </div>
            <input id="currentPassword" formControlName="currentPassword"
              [type]="showCurrentPassword ? 'text' : 'password'" placeholder="Contraseña Actual"
              class="w-full pl-12 pr-12 py-3.5 bg-transparent border border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 border-transparent focus:border-transparent focus:ring-yellow-500 transition text-sm dark:text-gray-100 placeholder-gray-400" />

            <button type="button" (click)="togglePasswordVisibility('current')"
              class="absolute inset-y-0 right-0 flex items-center pr-5 text-gray-400 hover:text-yellow-500 transition-colors bg-transparent border-0 cursor-pointer">
              <lucide-icon [img]="showCurrentPassword ? EyeOff : Eye" class="h-5 w-5"></lucide-icon>
            </button>

            <p *ngIf="getFieldError('currentPassword')"
              class="absolute -bottom-5 left-4 text-red-500 text-[10px] flex items-center">
              {{ getFieldError('currentPassword') }}
            </p>
          </div>

          <!-- New Password -->
          <div class="relative shadow-sm rounded-full bg-gray-50 dark:bg-gray-900/50 group">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
              <lucide-icon [img]="Lock"
                class="h-5 w-5 text-gray-400 group-focus-within:text-yellow-500 transition-colors"></lucide-icon>
            </div>
            <input id="newPassword" formControlName="newPassword" [type]="showNewPassword ? 'text' : 'password'"
              placeholder="Nueva Contraseña"
              class="w-full pl-12 pr-12 py-3.5 bg-transparent border border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 border-transparent focus:border-transparent focus:ring-yellow-500 transition text-sm dark:text-gray-100 placeholder-gray-400" />

            <button type="button" (click)="togglePasswordVisibility('new')"
              class="absolute inset-y-0 right-0 flex items-center pr-5 text-gray-400 hover:text-yellow-500 transition-colors bg-transparent border-0 cursor-pointer">
              <lucide-icon [img]="showNewPassword ? EyeOff : Eye" class="h-5 w-5"></lucide-icon>
            </button>

            <p *ngIf="getFieldError('newPassword')"
              class="absolute -bottom-5 left-4 text-red-500 text-[10px] flex items-center">
              {{ getFieldError('newPassword') }}
            </p>
          </div>

          <!-- Confirm Password -->
          <div class="relative shadow-sm rounded-full bg-gray-50 dark:bg-gray-900/50 group">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
              <lucide-icon [img]="Lock"
                class="h-5 w-5 text-gray-400 group-focus-within:text-yellow-500 transition-colors"></lucide-icon>
            </div>
            <input id="confirmPassword" formControlName="confirmPassword"
              [type]="showConfirmPassword ? 'text' : 'password'" placeholder="Confirme su nueva contraseña"
              class="w-full pl-12 pr-12 py-3.5 bg-transparent border border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 border-transparent focus:border-transparent focus:ring-yellow-500 transition text-sm dark:text-gray-100 placeholder-gray-400" />

            <button type="button" (click)="togglePasswordVisibility('confirm')"
              class="absolute inset-y-0 right-0 flex items-center pr-5 text-gray-400 hover:text-yellow-500 transition-colors bg-transparent border-0 cursor-pointer">
              <lucide-icon [img]="showConfirmPassword ? EyeOff : Eye" class="h-5 w-5"></lucide-icon>
            </button>

            <p *ngIf="getFieldError('confirmPassword')"
              class="absolute -bottom-5 left-4 text-red-500 text-[10px] flex items-center">
              {{ getFieldError('confirmPassword') }}
            </p>
          </div>

          <!-- Requisitos de contraseña integrado de forma limpia -->
          <div
            class="bg-gray-50 dark:bg-gray-900/30 rounded-2xl p-4 mt-8 border border-gray-100 dark:border-gray-700/50">
            <ul class="space-y-1.5 text-[11px] text-gray-500 dark:text-gray-400 font-medium tracking-wide">
              <li class="flex items-center gap-2 transition-colors duration-200"
                [ngClass]="passwordRules.minLength ? 'text-emerald-500' : ''">
                <lucide-icon [img]="passwordRules.minLength ? CheckCircle : Circle"
                  class="w-3.5 h-3.5 flex-shrink-0"></lucide-icon>
                <span>Mínimo 8 caracteres</span>
              </li>
              <li class="flex items-center gap-2 transition-colors duration-200"
                [ngClass]="(passwordRules.hasUpperCase && passwordRules.hasLowerCase) ? 'text-emerald-500' : ''">
                <lucide-icon [img]="(passwordRules.hasUpperCase && passwordRules.hasLowerCase) ? CheckCircle : Circle"
                  class="w-3.5 h-3.5 flex-shrink-0"></lucide-icon>
                <span>Mayúsculas y minúsculas</span>
              </li>
              <li class="flex items-center gap-2 transition-colors duration-200"
                [ngClass]="passwordRules.hasNumber ? 'text-emerald-500' : ''">
                <lucide-icon [img]="passwordRules.hasNumber ? CheckCircle : Circle"
                  class="w-3.5 h-3.5 flex-shrink-0"></lucide-icon>
                <span>Al menos un número</span>
              </li>
              <li class="flex items-center gap-2 transition-colors duration-200"
                [ngClass]="passwordRules.hasSpecialChar ? 'text-emerald-500' : ''">
                <lucide-icon [img]="passwordRules.hasSpecialChar ? CheckCircle : Circle"
                  class="w-3.5 h-3.5 flex-shrink-0"></lucide-icon>
                <span>Símbolos (!@#$%^&*)</span>
              </li>
              <li class="flex items-center gap-2 transition-colors duration-200"
                [ngClass]="passwordRules.passwordsMatch ? 'text-emerald-500' : ''">
                <lucide-icon [img]="passwordRules.passwordsMatch ? CheckCircle : Circle"
                  class="w-3.5 h-3.5 flex-shrink-0"></lucide-icon>
                <span>Las contraseñas coinciden</span>
              </li>
            </ul>
          </div>

          <!-- Botón Submit -->
          <button type="submit" [disabled]="changePasswordForm.invalid || loading"
            class="w-full mt-6 py-3.5 bg-yellow-500 text-[#0b132b] text-[15px] font-bold rounded-full hover:bg-yellow-400 disabled:opacity-70 disabled:cursor-not-allowed transition-all shadow-lg shadow-yellow-500/20 flex justify-center items-center uppercase tracking-widest">

            <svg *ngIf="loading" class="animate-spin h-5 w-5 mr-3 text-[#0b132b]" xmlns="http://www.w3.org/2000/svg"
              fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
            </svg>

            <ng-container *ngIf="loading; else submitText">
              Actualizando...
            </ng-container>
            <ng-template #submitText>
              Cambiar Contraseña
            </ng-template>
          </button>
        </form>

        <!-- Pie de página -->
        <div class="w-full text-center mt-12 pb-4">
          <p class="text-[10px] text-gray-400 dark:text-gray-500">
            Casa Bonita Residencial. Todos los derechos reservados.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>