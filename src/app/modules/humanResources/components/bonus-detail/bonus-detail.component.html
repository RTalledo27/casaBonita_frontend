<div class="bonus-detail-container max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 bg-gray-50 min-h-screen">
  <!-- Header -->
  <div class="header bg-white p-6 rounded-2xl shadow-sm border border-gray-200 mb-8">
    <button class="back-button inline-flex items-center gap-2 text-gray-700 hover:text-blue-600 font-medium mb-4 transition-all duration-200 hover:bg-blue-50 px-4 py-2 rounded-lg" (click)="goBack()">
      <lucide-angular [img]="ArrowLeft" size="20"></lucide-angular>
      Volver a Bonos
    </button>
    <div class="header-content">
      <h1 class="title flex items-center gap-4 text-4xl font-extrabold text-gray-900 mb-2">
        <lucide-angular [img]="Gift" size="28" class="title-icon text-blue-600"></lucide-angular>
        Detalle del Bono
      </h1>
      <p class="subtitle text-gray-500 text-lg">Revisa todos los detalles del bono, su estado y acciones disponibles.</p>
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-state bg-white p-12 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center">
      <div class="loading-spinner w-10 h-10 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin mb-4"></div>
      <p class="text-gray-600">Cargando información del bono...</p>
    </div>
  }

  <!-- Error State -->
  @if (error() && !loading()) {
    <div class="error-state bg-white p-12 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center text-center">
      <div class="error-icon text-red-500 mb-4">
        <lucide-angular [img]="XCircle" size="48"></lucide-angular>
      </div>
      <h3 class="text-xl font-semibold text-gray-900 mb-2">Error al cargar el bono</h3>
      <p class="text-gray-600 mb-6">{{ error() }}</p>
      <button class="btn btn-primary bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-medium transition-all duration-200 hover:shadow-lg hover:shadow-blue-500/25" (click)="goBack()">
        Volver a la lista
      </button>
    </div>
  }

  <!-- Bonus Detail -->
  @if (bonus() && !loading()) {
    <div class="bonus-detail">
      <!-- Status and Actions Bar -->
      <div class="status-actions-bar bg-white p-5 rounded-2xl shadow-sm border border-gray-200 mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="status-section">
          <span [class]="'status-badge inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold ' + getStatusClass(bonus()!.payment_status)">
            <lucide-angular [img]="getStatusIcon(bonus()!.payment_status)" size="16"></lucide-angular>
            {{ getStatusLabel(bonus()!.payment_status) }}
          </span>
        </div>
        
        <div class="actions-section flex flex-wrap gap-3">
          @if (canEdit()) {
            <button class="btn btn-secondary bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2.5 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 hover:shadow-md hover:-translate-y-0.5">
              <lucide-angular [img]="Edit" size="16"></lucide-angular>
              Editar
            </button>
          }
          
          @if (canApprove()) {
            <button class="btn btn-success bg-green-600 hover:bg-green-700 text-white px-4 py-2.5 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 hover:shadow-lg hover:shadow-green-500/25 hover:-translate-y-0.5">
              <lucide-angular [img]="CheckCircle" size="16"></lucide-angular>
              Aprobar
            </button>
          }
          
          @if (canReject()) {
            <button class="btn btn-warning bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2.5 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 hover:shadow-lg hover:shadow-yellow-500/25 hover:-translate-y-0.5">
              <lucide-angular [img]="XCircle" size="16"></lucide-angular>
              Rechazar
            </button>
          }
          
          @if (canDelete()) {
            <button class="btn btn-danger bg-red-600 hover:bg-red-700 text-white px-4 py-2.5 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 hover:shadow-lg hover:shadow-red-500/25 hover:-translate-y-0.5">
              <lucide-angular [img]="Trash2" size="16"></lucide-angular>
              Eliminar
            </button>
          }
        </div>
      </div>

      <!-- Main Information Cards -->
      <div class="info-cards grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Basic Information -->
        <div class="info-card bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:border-blue-300 transition-all duration-300">
          <div class="card-header bg-gray-50 px-6 py-5 border-b border-gray-200 flex items-center gap-4">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
              <lucide-angular [img]="Gift" size="20" class="text-white"></lucide-angular>
            </div>
            <h3 class="font-semibold text-lg text-gray-800">Información Básica</h3>
          </div>
          <div class="card-content p-6 space-y-4">
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">Nombre del Bono:</label>
              <span class="font-medium text-gray-900">{{ bonus()!.bonus_name }}</span>
            </div>
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">Tipo de Bono:</label>
              <span class="font-medium text-gray-900">{{ bonus()!.bonus_type?.type_name || 'Sin tipo' }}</span>
            </div>
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">Código del Tipo:</label>
              <span class="font-mono text-sm bg-gray-100 px-2 py-1 rounded">{{ bonus()!.bonus_type?.type_code || '-' }}</span>
            </div>
            @if (bonus()!.bonus_type?.description) {
              <div class="info-row flex flex-col gap-2">
                <label class="text-sm font-medium text-gray-600">Descripción del Tipo:</label>
                <span class="text-gray-700 bg-gray-50 p-3 rounded-lg">{{ bonus()!.bonus_type?.description }}</span>
              </div>
            }
          </div>
        </div>

        <!-- Employee Information -->
        <div class="info-card bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:border-purple-300 transition-all duration-300">
          <div class="card-header bg-gray-50 px-6 py-5 border-b border-gray-200 flex items-center gap-4">
            <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
              <lucide-angular [img]="User" size="20" class="text-white"></lucide-angular>
            </div>
            <h3 class="font-semibold text-lg text-gray-800">Información del Empleado</h3>
          </div>
          <div class="card-content p-6 space-y-4">
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">ID del Empleado:</label>
              <span class="font-mono text-sm bg-gray-100 px-2 py-1 rounded">{{ bonus()!.employee_id }}</span>
            </div>
            @if (bonus()!.employee) {
              <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
                <label class="text-sm font-medium text-gray-600">Nombre:</label>
                <span class="font-medium text-gray-900">{{ bonus()!.employee?.user?.first_name }} {{ bonus()!.employee?.user?.last_name }}</span>
              </div>
              <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
                <label class="text-sm font-medium text-gray-600">Tipo de Empleado:</label>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">{{ bonus()!.employee?.employee_type }}</span>
              </div>
            }
          </div>
        </div>

        <!-- Financial Information -->
        <div class="info-card bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:border-green-300 transition-all duration-300">
          <div class="card-header bg-gray-50 px-6 py-5 border-b border-gray-200 flex items-center gap-4">
            <div class="w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center">
              <lucide-angular [img]="DollarSign" size="20" class="text-white"></lucide-angular>
            </div>
            <h3 class="font-semibold text-lg text-gray-800">Información Financiera</h3>
          </div>
          <div class="card-content p-6 space-y-4">
            <div class="info-row highlight bg-green-50 p-4 rounded-lg border border-green-200 flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-green-700">Monto del Bono:</label>
              <span class="amount text-2xl font-bold text-green-600">{{ formatCurrency(bonus()!.bonus_amount || 0) }}</span>
            </div>
            @if (bonus()!.target_amount) {
              <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
                <label class="text-sm font-medium text-gray-600">Monto Objetivo:</label>
                <span class="font-semibold text-gray-900">{{ formatCurrency(bonus()!.target_amount) }}</span>
              </div>
            }
            @if (bonus()!.achieved_amount) {
              <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
                <label class="text-sm font-medium text-gray-600">Monto Alcanzado:</label>
                <span class="font-semibold text-gray-900">{{ formatCurrency(bonus()!.achieved_amount) }}</span>
              </div>
            }
            @if (bonus()!.achievement_percentage) {
              <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
                <label class="text-sm font-medium text-gray-600">Porcentaje de Logro:</label>
                <div class="flex items-center gap-2">
                  <div class="w-20 bg-gray-200 rounded-full h-2">
                    <div class="bg-blue-600 h-2 rounded-full" [style.width.%]="bonus()!.achievement_percentage"></div>
                  </div>
                  <span class="font-semibold text-blue-600">{{ bonus()!.achievement_percentage }}%</span>
                </div>
              </div>
            }
          </div>
        </div>

        <!-- Period Information -->
        <div class="info-card bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:border-orange-300 transition-all duration-300">
          <div class="card-header bg-gray-50 px-6 py-5 border-b border-gray-200 flex items-center gap-4">
            <div class="w-8 h-8 bg-orange-600 rounded-lg flex items-center justify-center">
              <lucide-angular [img]="Calendar" size="20" class="text-white"></lucide-angular>
            </div>
            <h3 class="font-semibold text-lg text-gray-800">Período</h3>
          </div>
          <div class="card-content p-6 space-y-4">
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">Año:</label>
              <span class="font-bold text-xl text-gray-900">{{ bonus()!.period_year }}</span>
            </div>
            <div class="info-row flex flex-col sm:flex-row sm:justify-between gap-1">
              <label class="text-sm font-medium text-gray-600">Mes:</label>
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-orange-100 text-orange-800">{{ bonus()!.period_month ? getMonthName(bonus()!.period_month) : '-' }}</span>
            </div>
          </div>
        </div>

        <!-- Goal Information -->
        @if (bonus()!.bonus_goal) {
          <div class="info-card bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow duration-200 lg:col-span-2">
            <div class="card-header bg-gradient-to-r from-indigo-50 to-indigo-100 px-6 py-4 border-b border-gray-100 flex items-center gap-3">
              <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                <lucide-angular [img]="Target" size="20" class="text-white"></lucide-angular>
              </div>
              <h3 class="font-semibold text-gray-900">Meta Asociada</h3>
            </div>
            <div class="card-content p-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="info-row flex flex-col gap-1">
                  <label class="text-sm font-medium text-gray-600">Nombre de la Meta:</label>
                  <span class="font-medium text-gray-900">{{ bonus()!.bonus_goal?.goal_name }}</span>
                </div>
                <div class="info-row flex flex-col gap-1">
                  <label class="text-sm font-medium text-gray-600">Logro Mínimo:</label>
                  <span class="font-medium text-gray-900">{{ bonus()!.bonus_goal?.min_achievement }}</span>
                </div>
                @if (bonus()!.bonus_goal?.max_achievement) {
                  <div class="info-row flex flex-col gap-1">
                    <label class="text-sm font-medium text-gray-600">Logro Máximo:</label>
                    <span class="font-medium text-gray-900">{{ bonus()!.bonus_goal?.max_achievement }}</span>
                  </div>
                }
                @if (bonus()!.bonus_goal?.bonus_amount) {
                  <div class="detail-item flex flex-col gap-1">
                    <label class="text-sm font-medium text-gray-600">Monto del Bono:</label>
                    <span class="font-semibold text-green-600">{{ formatCurrency(bonus()!.bonus_goal?.bonus_amount) }}</span>
                  </div>
                }
                @if (bonus()!.bonus_goal?.bonus_percentage) {
                  <div class="info-row flex flex-col gap-1">
                    <label class="text-sm font-medium text-gray-600">Porcentaje del Bono:</label>
                    <span class="font-medium text-indigo-600">{{ bonus()!.bonus_goal?.bonus_percentage }}%</span>
                  </div>
                }
              </div>
            </div>
          </div>
        }

        <!-- Dates Information -->
        <div class="info-card bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow duration-200 lg:col-span-2">
          <div class="card-header bg-gradient-to-r from-teal-50 to-teal-100 px-6 py-4 border-b border-gray-100 flex items-center gap-3">
            <div class="w-8 h-8 bg-teal-600 rounded-lg flex items-center justify-center">
              <lucide-angular [img]="Calendar" size="20" class="text-white"></lucide-angular>
            </div>
            <h3 class="font-semibold text-gray-900">Fechas Importantes</h3>
          </div>
          <div class="card-content p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="info-row flex flex-col gap-1">
                <label class="text-sm font-medium text-gray-600">Fecha de Creación:</label>
                <span class="font-medium text-gray-900 bg-gray-50 px-3 py-2 rounded-lg">{{ formatDate(bonus()!.created_at) }}</span>
              </div>
              @if (bonus()!.approved_at) {
                <div class="info-row flex flex-col gap-1">
                  <label class="text-sm font-medium text-gray-600">Fecha de Aprobación:</label>
                  <span class="font-medium text-green-700 bg-green-50 px-3 py-2 rounded-lg">{{ formatDate(bonus()!.approved_at) }}</span>
                </div>
              }
              @if (bonus()!.payment_date) {
                <div class="info-row flex flex-col gap-1">
                  <label class="text-sm font-medium text-gray-600">Fecha de Pago:</label>
                  <span class="font-medium text-blue-700 bg-blue-50 px-3 py-2 rounded-lg">{{ formatDate(bonus()!.payment_date) }}</span>
                </div>
              }
            </div>
          </div>
        </div>

        <!-- Additional Information -->
        @if (bonus()!.notes) {
          <div class="info-card full-width bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow duration-200 lg:col-span-2">
            <div class="card-header bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-100 flex items-center gap-3">
              <div class="w-8 h-8 bg-gray-600 rounded-lg flex items-center justify-center">
                <lucide-angular [img]="Gift" size="20" class="text-white"></lucide-angular>
              </div>
              <h3 class="font-semibold text-gray-900">Información Adicional</h3>
            </div>
            <div class="card-content p-6">
              <div class="info-row flex flex-col gap-2">
                <label class="text-sm font-medium text-gray-600">Notas:</label>
                <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-gray-400">
                  <span class="text-gray-700 leading-relaxed">{{ bonus()!.notes }}</span>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>
